<!DOCTYPE html>
<html>

<head>
  <title><%= title %></title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, shrink-to-fit=no user-scalable=0">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/magnific-popup.css">
  <link rel="stylesheet" href="/css/jquery-ui.css">
  <link rel="stylesheet" href="/css/owl.carousel.min.css">
  <link rel="stylesheet" href="/css/owl.theme.default.min.css">
  <link rel="stylesheet" href="/css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="/css/timedropper.css">
  <link rel="stylesheet" href="/css/animate.css">

  <link rel="stylesheet" href="/css/aos.css">

  <link rel="stylesheet" href="/css/flaticon.css">
  <link rel="stylesheet" href="/css/icomoon.css">

  <link rel="stylesheet" href="//cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/build/css/bootstrap-datetimepicker.css">

  <link rel="stylesheet" href="/css/views/style.css">
  <link rel="stylesheet" href="/css/views/main.css">
  <link rel="stylesheet" href="/css/views/noncover.css">
  <link rel="stylesheet" href="/css/views/writepost.css">
  <link rel="stylesheet" href="/css/views/calendar.css">
  <link rel="stylesheet" href="/css/views/profile.css">
</head>

<body>

  <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-settings js-menu-toggle"></span>
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->

    
    <!--상단바-->
    <div class="site-navbar-wrap js-site-navbar bg-white">

      <div class="container">
        <div class="site-navbar bg-light">
          <div class="py-1">
            <div class="row align-items-center" id="site-navbar-line">
              <div class="col-2">
                <div class="d-inline-block  ml-md-0 mr-auto py-3"><a href="#"
                  class="site-menu-toggle js-menu-toggle"><span class="icon-arrow_back h3" id="nav-back"></span></a></div>
              </div>
              <div class="col-10">
                <nav class="site-navigation text-right" role="navigation">
                  <div class="container">
                    <!-- d-lg-none -->
                    
                    <!-- d-lg-block -->
                  </div>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="site-section bg-light">
    <div class="container" id="writeForm">
      <div class="row" id="writeRow">
        <div id="write-form" class="col-lg-12">
          <div class="form-group col-12">
            <a id="birthdayCetion"><%=title%></a>
            <div class = "row">
            <div class="col-12 headCountInputDiv"><input type="number" class="birthdayinput writeInput" id="headcountText" onblur="numberLengthCheck(this)"></div>
            </div>
          </div>

        </div>
          <div class="col-12" id="button-div">
            <a id="update-button" class="col-12 btn btn-primary px-4 py-2"  ><%=saveText%></a>
          </div>
      </div>
    </div>

  </div>



</body>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/lib/jquery-migrate-3.0.1.min.js"></script>
<script src="/js/lib/jquery-ui.js"></script>
<script src="/js/lib/popper.min.js"></script>
<script src="/js/lib/owl.carousel.min.js"></script>
<script src="/js/lib/jquery.stellar.min.js"></script>
<script src="/js/lib/jquery.magnific-popup.min.js"></script>
<script src="/js/lib/bootstrap-datepicker.js"></script>
<script src="/js/lib/timedropper.js"></script>
<script src="/js/lib/aos.js"></script>

<script src="/js/lib/mediaelement-and-player.min.js"></script>

<script src="/js/views/main.js"></script>


<script type="text/javascript">
  $(document).ready(function () {

    var loginStatus  = "<%=loginStatus %>";
    var userId = "<%=userId%>";

    var no = location.href
      .substr(location.href.lastIndexOf('=') + 1);

    var headcountnow = null;

    var allData = {
          "writer" : userId,
          "no" : no
        }

        $.ajax({
        url: "/board/managiment/getheadcount",
        data: allData,
        async: false,
        type: "get",
        success: function (data) {
          if(data['result'] == true){
          if(data.rows.length == 0){
            alert("<%=errorMessage%>");
            history.back();
          }
          else{
            
            $.each(data.rows, function (index, item) {
            $("#headcountText").val(item.HEADCOUNT);
            headcountnow = item.HEADCOUNT_NOW;
            });
          }

            $("#update-button").click(function(){

              headCountText = $("#headcountText").val();

              
            if(headCountText < headcountnow || headCountText > 128){
              alert(headcountnow+"<%=heaCountAlerText%>");
              return;
            }else{

              var allData = {
                "headCount" : headCountText,
                "writer" : userId,
                "no" : no
              }

              $.ajax({
              url: "/board/managiment/updateheadcount",
              data: allData,
              async: false,
              type: "get",
              success: function (data) {
                if(data['result'] == true){
                alert("<%=successInfo%>");
                history.back();
                }else if(data['result'] == false){
                  alert("<%=errorInfo%>");
                }
              },
              beforeSend: function () {
              },
              complete: function () {
              }
            });
          }
        });
        }else if(data['result'] == false){
          
          alert("<%=errorInfo%>");
        }
      },
			beforeSend: function () {
			},
			complete: function () {
			}
    });
  });

  function numberLengthCheck(eventInput){
    var inputText = $(eventInput).val();
    if(inputText.replace(/[0-9]/g, "").length > 0) {
      $(eventInput).val('');
    }

    if(inputText < 2) {
      $(eventInput).val(2);
    }
    if(inputText > 100){
      $(eventInput).val(100);
    }
  }

</script>



</html>