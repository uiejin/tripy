<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, shrink-to-fit=no user-scalable=0">

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/magnific-popup.css">
  <link rel="stylesheet" href="/css/jquery-ui.css">
  <link rel="stylesheet" href="/css/owl.carousel.min.css">
  <link rel="stylesheet" href="/css/owl.theme.default.min.css">
  <link rel="stylesheet" href="/css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="/css/animate.css">

  <link rel="stylesheet" href="/css/aos.css">

  <link rel="stylesheet" href="/css/flaticon.css">
  <link rel="stylesheet" href="/css/icomoon.css">

  <link rel="stylesheet"
    href="//cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/build/css/bootstrap-datetimepicker.css">

  <link rel="stylesheet" href="/css/views/style.css">
  <link rel="stylesheet" href="/css/views/main.css">
  <link rel="stylesheet" href="/css/views/noncover.css">
  <link rel="stylesheet" href="/css/views/writepost.css">
  <link rel="stylesheet" href="/css/views/search.css">
  <link rel="stylesheet" href="/css/views/calendar.css">
  <link rel="stylesheet" href="/css/views/myplan.css">
  <link rel="stylesheet" href="/css/views/mytour.css">

</head>

<body>

  <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-settings js-menu-toggle"></span>
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->

    <!--상단바-->
    <div class="site-navbar-wrap js-site-navbar bg-white">

      <div class="container">
        <div class="site-navbar bg-light">
          <div class="py-1">
            <div class="row align-items-center" id="site-navbar-line">
              <div class="col-10">
                <div class="d-inline-block  ml-md-0 mr-auto py-3"><a href="#"
                    class="site-menu-toggle js-menu-toggle"><span class="icon-arrow_back h3" id="nav-back"></span></a>
                </div>
              </div>
              <div class="col-2">
                <nav class="site-navigation text-right" role="navigation">
                  <div class="container">
                    <!-- d-lg-none -->

                    <!-- d-lg-block -->
                  </div>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="site-section col-md-12" id="searchPostForm">
    <div class="container" id=boardForm>
      <div class="row col-md-12" id="post">

        <!--게시판 커스텀 -->
        <div class="ajaxboardForm" id="newboardform">
        </div>
      </div>
    </div>
  </div>

  <div id="s_id" data-prodnumber="${sessionScope.id}" />
  <div id="s_auth" data-prodnumber="${sessionScope.authority}" />

  </div>

</body>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/lib/jquery-migrate-3.0.1.min.js"></script>
<script src="/js/lib/jquery-ui.js"></script>
<script src="/js/lib/popper.min.js"></script>
<script src="/js/lib/owl.carousel.min.js"></script>
<script src="/js/lib/jquery.stellar.min.js"></script>
<script src="/js/lib/jquery.magnific-popup.min.js"></script>
<script src="/js/lib/bootstrap-datepicker.js"></script>
<script src="/js/lib/timedropper.js"></script>
<script src="/js/lib/aos.js"></script>

<script src="/js/lib/mediaelement-and-player.min.js"></script>

<script src="/js/views/main.js"></script>

<script type="text/javascript">
  $(document).ready(function () {
    var loginStatus = "<%=loginStatus %>";
    var userId = "<%=userId%>";

    var country = ['대한민국', '중국', '일본', '베트남', '태국', '라오스', '미얀마'];

    var countrycode = "";
    var areacode = "";
    var categorycode = "";

    var enddate = null;
    var startdate = null;

    var age = "<%=userAge%>";
    var gender = "<%=userGender%>";

    var nowdate = getTimeStamp();

    urlparam = getUrlParams();
    areacode = urlparam.areacode;
    enddate = urlparam.enddate;
    startdate = urlparam.startdate;
    categorycode = urlparam.categorycode;

    if (areacode == undefined) {
      areacode = "";
    }
    if (countrycode == undefined) {
      countrycode = "";
    }

    if (categorycode == undefined) {
      categorycode = "";
    }
    if (startdate == undefined) {
      startdate = nowdate;
    }
    if (enddate == undefined) {
      enddate = nowdate;
    }

    var allData = {
      "areacode": areacode,
      "category": categorycode,
      "startdate": startdate,
      "enddate": enddate,
      "text": "",
      "age": age,
      "gender": gender
    }


    $.ajax({
      url: "/board/searchparty",
      data: allData,
      async: false,
      type: "get",
      success: function (data) {
        $.each(data.rows, function (index, item) {
          var source = "<div id=\"form-board" + item.NO + "\">" +
            "<div id=\"boardLine1\"><a><span id=\"boardArea\">" + "[" + item.AREA + "]";
          if (item.ACHIEVENENTSEQ) {
            source += " [" + item.ACHIEVEMENT_TITLE + "]";
          }
          source += "</span><span class=\"text-right\" id=\"boardCategory" + item.SEQ + "\">";
          if (item.LIMIT_GENDER == "male") {
            source = source + "[<%=maleText%>]";
          } else if (item.LIMIT_GENDER == "female") {

            source = source + "[<%=femaleText%>]";
          }
          source = source + "[" + item.CATEGORY + "]</span></div>" +
            "<div id=\"boardLine1\"><span id=\"boardTitle\">" + item.TITLE + "</span>";

          if (item.HEADCOUNT == item.HEADCOUNT_NOW) {
            source = source + "<span class=\"text-right\" id=\"boardFillHeadCount\">" + "<%=fillHeadCountText%>" + "</span></span></div>";
          } else {
            source = source + "<span class=\"text-right\" id=\"boardHeadCount\">" + item.HEADCOUNT_NOW + "/" + item.HEADCOUNT + "명</span></span></div>";
          }
          source = source + "<div id=\"boardLine2\"><a><span id=\"boardWriter\">" + item.NAME + "</span><span id=\"boardDate" + item.SEQ + "\" class=\"btn btn-primary px-4 py-3 text-uppercase boardDate\">" +
            item.MEET_DATE + " " + item.MEET_TIME + "</span></a></div><hr class=\"lineEvent\"></div>";
          $("#newboardform").append(source);

          $("#form-board" + item.NO).click(function () {
            location.href = "./read?no=" + item.NO;
          });

        });
        if (data.rows.length == 0) {
          var source = "<div id=\"nullpartyText\" class = \"text-center\"><%=nullparty%></div>";
          $("#newboardform").append(source);
        }

      },
      beforeSend: function () {
      },
      complete: function () {
      }
    });



    function getUrlParams() {
      var params = {};
      window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) { params[key] = value; });
      return params;
    }

    function getTimeStamp() {
      var d = new Date();
      var s =
        leadingZeros(d.getFullYear(), 4) + '-' +
        leadingZeros(d.getMonth() + 1, 2) + '-' +
        leadingZeros(d.getDate(), 2) + ' ' +

        leadingZeros(d.getHours(), 2) + ':' +
        leadingZeros(d.getMinutes(), 2) + ':' +
        leadingZeros(d.getSeconds(), 2);

      return s;
    }

    function leadingZeros(n, digits) {
      var zero = '';
      n = n.toString();

      if (n.length < digits) {
        for (i = 0; i < digits - n.length; i++)
          zero += '0';
      }
      return zero + n;
    }



  });
</script>



</html>